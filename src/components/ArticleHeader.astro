---
/**
 * 文章头部信息组件
 * 用于显示 Markdown 文章的 frontmatter 信息
 * 包括：标题、描述、作者、发布日期、标签等
 */

interface Props {
    title: string;
    description?: string;
    author?: string;
    pubDate?: string | Date;
    tags?: string[];
    image?: {
        url: string;
        alt?: string;
    };
}

const { title, description, author, pubDate, tags, image } = Astro.props;

// 获取背景图片 URL
const getBackgroundImage = (): string => {
    // 使用 frontmatter 中的图片
    if (image?.url) {
        return image.url;
    }
    
    // 默认图片（通用）
    return "https://images.unsplash.com/photo-1516321318423-f06f70d504d0?w=1200&h=400&fit=crop";
};

const backgroundImageUrl = getBackgroundImage();

// 处理日期格式
const formatDate = (date: string | Date | undefined): string => {
    if (!date) return "";
    if (typeof date === 'string') {
        return date.slice(0, 10);
    }
    return date.toISOString().slice(0, 10);
};
---

<!-- 文章头部背景区域 -->
<div class="article-hero mb-8 rounded-lg overflow-hidden" style={{backgroundImage: `url('${backgroundImageUrl}')`}}>
    <!-- 背景遮罩 -->
    <div class="article-hero-overlay"></div>
    
    <!-- 文章头部信息块 -->
    <div class="article-hero-content">
        <!-- 文章标题 -->
        <h1 class="text-4xl font-bold mb-4 text-white drop-shadow-lg">{title}</h1>
    
    <!-- 文章描述 -->
    {
        description && (
            <p class="text-lg mb-4 text-white/90 italic drop-shadow">
                {description}
            </p>
        )
    }
    
    <!-- 文章元数据（作者、日期） -->
    <div class="flex flex-wrap gap-4 justify-center text-sm mb-4 text-white/80">
        {
            author && (
                <span class="flex items-center gap-1">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                    {author}
                </span>
            )
        }
        {
            pubDate && (
                <span class="flex items-center gap-1">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11z"/>
                    </svg>
                    {formatDate(pubDate)}
                </span>
            )
        }
    </div>
    
    <!-- 文章标签 -->
    {
        tags && tags.length > 0 && (
            <div class="flex flex-wrap gap-2 justify-center">
                {tags.map((tag: string) => (
                    <a
                        href={`/tags/${tag}`}
                        class="inline-flex items-center gap-1 px-3 py-1 text-xs rounded-full bg-white/20 text-white border border-white/30 hover:bg-white/30 transition-colors"
                    >
                        <span>#</span>{tag}
                    </a>
                ))}
            </div>
        )
    }
    </div>
</div>

<style>
    .article-hero {
        position: relative;
        min-height: 300px;
        background-size: cover;
        background-position: center;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .article-hero-overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, rgba(0, 31, 92, 0.7) 0%, rgba(26, 13, 77, 0.8) 100%);
        z-index: 1;
    }

    .article-hero-content {
        position: relative;
        z-index: 2;
        width: 100%;
        padding: 3rem;
        max-width: 800px;
        margin: 0 auto;
        text-align: center;
    }

    @media (max-width: 768px) {
        .article-hero {
            min-height: 200px;
        }
        
        .article-hero-content {
            padding: 2rem;
        }
        
        :global(.article-hero-content h1) {
            font-size: 1.875rem !important;
        }
    }

    /* 组件样式 */
    svg {
        display: inline;
    }
</style>
